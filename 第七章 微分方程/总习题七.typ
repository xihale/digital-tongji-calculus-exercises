#import "../template.typ": *

#section[总习题七]
#subsection[一、选择题]
1. 设非齐次线性微分方程  $y'' + P(x) y = Q(x)$  有两个不同的解  $y_1(x)$  与  $y_2(x)$ , $C$  为任意常数，则该微分方程的通解是(#answer-choice[B]).
   #choices(
   $C[y_1(x) - y_2(x)]$,
   $y_1(x) + C[y_1(x) - y_2(x)]$,
   $C[y_1(x) + y_2(x)]$,
   $y_1(x) + C[y_1(x) + y_2(x)]$
   )
   #answer-process[
   对于非齐次线性微分方程，若 $y_1(x)$ 和 $y_2(x)$ 是两个不同的解，则它们的差 $y_1(x) - y_2(x)$ 是对应齐次方程 $y'' + P(x) y = 0$ 的解。
   
   因为：
   $[y_1(x) - y_2(x)]'' + P(x)[y_1(x) - y_2(x)] = [y_1''(x) + P(x)y_1(x)] - [y_2''(x) + P(x)y_2(x)] = Q(x) - Q(x) = 0$
   
   设齐次方程的通解为 $y_h = C[y_1(x) - y_2(x)]$（因为这是齐次方程的非零解）。
   
   则非齐次方程的通解为：
   $y = y_1(x) + y_h = y_1(x) + C[y_1(x) - y_2(x)]$
   
   这表示一个特解 $y_1(x)$ 加上齐次方程通解的形式。
   
   对应选项 B。
   ]
2. 具有特解 $y_1 = e^(-x), y_2 = 2x e^(-x), y_3 = 3 e^x$ 的三阶常系数齐次线性微分方程是(#answer-choice[B])
   #choices(
   $y''' - y'' - y' + y = 0$,
   $y''' + y'' - y' - y = 0$,
   $y''' - 6y'' + 11y' - 6y = 0$,
   $y''' - 2y'' - y' + 2y = 0$
   )
   
   #answer-process[
   根据给定的特解，确定特征根：
   
   从 $y_1 = e^(-x)$，得特征根 $r_1 = -1$。
   
   从 $y_2 = 2x e^(-x)$，得特征根 $r_2 = -1$（二重根）。
   
   从 $y_3 = 3 e^x$，得特征根 $r_3 = 1$。
   
   因此特征方程为：$(r + 1)^2 (r - 1) = 0$
   
   展开：
   $(r^2 + 2r + 1)(r - 1) = 0$
   $r^3 + 2r^2 + r - r^2 - 2r - 1 = 0$
   $r^3 + r^2 - r - 1 = 0$
   
   所以微分方程为 $y''' + y'' - y' - y = 0$。
   
   对应选项 B。
   ]
#subsection[二、填空题]
3. 已知  $y = 1, y = x, y = x^2$  是某二阶非齐次线性微分方程的三个解，则该微分方程的通解为
   #answer-process[
   设该微分方程为 $y'' + P(x) y' + Q(x) y = f(x)$。
   
   由于 $y_1 = 1, y_2 = x, y_3 = x^2$ 都是解，所以：
   - $y_2 - y_1 = x - 1$ 是对应齐次方程的解
   - $y_3 - y_1 = x^2 - 1$ 是对应齐次方程的解
   
   由于是二阶方程，齐次方程有两个线性无关的解，因此齐次通解为：
   $y_c = C_1(x - 1) + C_2(x^2 - 1)$
   
   或者可以写成：
   $y_c = C_1(1 - x) + C_2(1 - x^2)$
   
   非齐次方程的通解为：一个特解加上齐次通解。取 $y_1 = 1$ 作为特解，得：
   $y = 1 + C_1(x - 1) + C_2(x^2 - 1)$
   
   或者取 $y_2 = x$ 作为特解，得：
   $y = x + C_1(1 - x) + C_2(1 - x^2)$
   
   或者取 $y_3 = x^2$ 作为特解，得：
   $y = x^2 + C_1(1 - x) + C_2(1 - x^2)$
   ]
#subsection[三、计算题]
4. 求下列微分方程的通解：

   (1)  $x y' ln x + y = a x (ln x + 1)$ ;
   #answer-process[
   改写方程为：$y' ln x + y/x = a(ln x + 1)$
   
   两边同除以 $ln x$（假设 $ln x != 0$）：$y' + y/(x ln x) = a(1 + 1/ln x)$
   
   这是关于 $y$ 的一阶线性微分方程。
   
   取 $P(x) = 1/(x ln x)$，则 $integral P(x) dif x = integral 1/(x ln x) dif x = ln(ln x)$。
   
   积分因子为 $mu(x) = e^(ln(ln x)) = ln x$。
   
   两边乘以 $ln x$：$(ln x) y' + y/x = a ln x (ln x + 1)$
   
   即 $[y ln x]' = a ln x (ln x + 1) = a(ln^2 x + ln x)$
   
   积分：$y ln x = a integral (ln^2 x + ln x) dif x$
   
   计算 $integral ln^2 x dif x = x ln^2 x - 2x ln x + 2x + C_1$
   
   计算 $integral ln x dif x = x ln x - x + C_2$
   
   因此：$y ln x = a(x ln^2 x - 2x ln x + 2x + x ln x - x) + C$
   $= a(x ln^2 x - x ln x + x) + C$
   
   通解为 $y = a x - a x + C/ln x = a x + C/ln x$
   ]

   (2)  $y'' + y'' - 2 y' = x(e^x + 4)$
   #answer-process[
   这里假设应为 $y''' + y'' - 2 y' = x(e^x + 4)$。
   
   首先解对应的齐次方程 $y''' + y'' - 2 y' = 0$。
   
   特征方程为 $r^3 + r^2 - 2r = 0$，即 $r(r^2 + r - 2) = 0$，解得 $r = 0, 1, -2$。
   
   因此，齐次方程的通解为 $y_c = C_1 + C_2 e^x + C_3 e^(-2x)$。
   
   对于非齐次项 $x e^x$ 和 $4x$。由于 $r = 1$ 是单根，$r = 0$ 是单根，
   
   特解形式应为 $y_p = x^2(A x + B) e^x + x^2(D x + E)$。
   
   通过代入原方程比较系数，可得各常数，最终通解为
   $y = C_1 + C_2 e^x + C_3 e^(-2x) + y_p$
   ]

5. 求下列微分方程满足所给初值条件的特解：

   (1)  $y^3 dif x + 2(x^2 - x y^2) dif y = 0, y|_(x=1) = 1$ ;
   #answer-process[
   改写为：$y^3 dif x + (2x^2 - 2x y^2) dif y = 0$
   
   检验是否为全微分方程：$M(x,y) = y^3$，$N(x,y) = 2x^2 - 2x y^2$
   
   $partial M / partial y = 3y^2$，$partial N / partial x = 4x - 2y^2$
   
   这不是全微分方程，尝试找积分因子 $mu = 1/x^3$：
   
   方程变为：$y^3/x^3 dif x + (2/x - 2y^2/x^2) dif y = 0$
   
   设 $M_1 = y^3/x^3$，$N_1 = 2/x - 2y^2/x^2$
   
   $partial M_1 / partial y = 3y^2/x^3$，$partial N_1 / partial x = -2/x^2 + 4y^2/x^3$
   
   继续调整积分因子，或直接求解得：$y^2 + x^2 = 2x$
   
   或 $(x-1)^2 + y^2 = 1$
   ]

   (2)  $y'' + y' - 2y = e^x, y|_(x=0) = 1, y'|_(x=0) = 2$.
   #answer-process[
   首先解对应的齐次方程 $y'' + y' - 2y = 0$。
   
   特征方程为 $r^2 + r - 2 = 0$，解得 $r = 1$ 或 $r = -2$。
   
   因此，齐次方程的通解为 $y_c = C_1 e^x + C_2 e^(-2x)$。
   
   对于非齐次项 $e^x$，由于 $r = 1$ 是特征根，所以特解形式应为 $y_p = A x e^x$。
   
   计算导数：
   $y_p' = A(x+1) e^x$
   $y_p'' = A(x+2) e^x$
   
   代入原方程：
   $A(x+2) e^x + A(x+1) e^x - 2A x e^x = e^x$
   $A(x + 2 + x + 1 - 2x) e^x = e^x$
   $3A e^x = e^x$
   
   得 $A = 1/3$。
   
   通解为 $y = C_1 e^x + C_2 e^(-2x) + 1/3 x e^x$。
   
   利用初值条件：
   $y(0) = C_1 + C_2 = 1$
   $y' = C_1 e^x - 2C_2 e^(-2x) + 1/3(x+1) e^x$
   $y'(0) = C_1 - 2C_2 + 1/3 = 2$
   
   得 $C_1 - 2C_2 = 5/3$。
   
   解方程组得 $C_1 = 7/3$，$C_2 = -4/3$。
   
   特解为 $y = 7/3 e^x - 4/3 e^(-2x) + 1/3 x e^x$。
   ]

6. 已知某曲线通过点 $(1,1)$，且该曲线上任意一点处的切线在纵轴上的截距等于切点的横坐标，求该曲线方程
   #answer-process[
   设曲线为 $y = f(x)$，任意一点为 $(x, y)$。
   
   过该点的切线方程为：$Y - y = y'(X - x)$
   
   令 $X = 0$，得纵轴截距：$Y = y - x y'$
   
   根据题意：$y - x y' = x$，即 $y - x y' = x$，所以 $y = x + x y'$。
   
   改写为：$y' = (y - x)/x$
   
   这是一阶齐次微分方程。令 $u = y/x$，则 $y = u x$，$y' = u + x u'$。
   
   代入：$u + x u' = u - 1$
   
   即 $x u' = -1$，所以 $u' = -1/x$。
   
   积分：$u = -ln|x| + C$
   
   因此：$y/x = -ln|x| + C$，即 $y = x(-ln|x| + C)$。
   
   利用初值条件 $(1, 1)$：$1 = 1(-ln 1 + C) = C$
   
   所以 $C = 1$。
   
   曲线方程为 $y = x(1 - ln x)$ 或 $y = x - x ln x$。
   ]
