#import "../template.typ": *

#section[第八节 常系数非齐次线性微分方程]
#subsection[一、选择题]
1. 微分方程  $y'' - y = 3 e^x + 2$  的一个特解具有形式  $(a, b$  为常数)(#h(2em)).
   #choices(
   [$y^* = a e^x + b$],
   [$y^* = a e^x + b x$],
   [$y^* = a x e^x + b$],
   [$y^* = a x e^x + b x$]
   )
   (#answer-choice[C])
   #answer-process[
   首先分析特征方程：$r^2 - 1 = 0$，解得 $r = \pm 1$。
   
   对于非齐次项 $3 e^x$，由于 $e^x$ 对应的特征根 $r = 1$ 是单根，所以特解形式应为 $A x e^x$。
   
   对于非齐次项 $2$（即 $2 e^(0x)$），由于 $0$ 不是特征根，所以特解形式应为 $B$。
   
   因此，整个方程的特解形式为 $y^* = A x e^x + B$，对应选项 C。
   ]

2. 微分方程  $y'' + y = sin x$  的一个特解具有形式(#h(2em)).
   #choices(
   [$y^* = a sin x$],
   [$y^* = a cos x$],
   [$y^* = x(a sin x + b cos x)$],
   [$y^* = a cos x + b sin x$]
   )
   (#answer-choice[C])
   #answer-process[
   首先分析特征方程：$r^2 + 1 = 0$，解得 $r = \pm i$。
   
   对于非齐次项 $sin x$，由于 $sin x$ 对应的特征根 $r = i$ 是单根，所以特解形式应为 $x (A cos x + B sin x)$。
   
   因此，特解形式为 $y^* = x(a sin x + b cos x)$，对应选项 C。
   ]

#subsection[二、计算题]
3. 求下列微分方程的通解：

   (1)  $2 y'' + 5 y' = 5 x^2 - 2x - 1$;
   #answer-process[
   首先解对应的齐次方程 $2 y'' + 5 y' = 0$。
   
   特征方程为 $2 r^2 + 5 r = 0$，解得 $r = 0$ 或 $r = -5/2$。
   
   因此，齐次方程的通解为 $y_c = C_1 + C_2 e^(-5/2 x)$。
   
   对于非齐次项 $5 x^2 - 2x - 1$，由于 $r = 0$ 是单根，所以特解形式应为 $y_p = x (A x^2 + B x + C) = A x^3 + B x^2 + C x$。
   
   计算导数：
   $y_p' = 3A x^2 + 2B x + C$
   $y_p'' = 6A x + 2B$
   
   代入原方程：
   $2 (6A x + 2B) + 5 (3A x^2 + 2B x + C) = 5 x^2 - 2x - 1$
   $15A x^2 + (12A + 10B) x + (4B + 5C) = 5 x^2 - 2x - 1$
   
   比较系数：
   $15A = 5$，得 $A = 1/3$
   $12A + 10B = -2$，代入 $A = 1/3$，得 $B = -3/5$
   $4B + 5C = -1$，代入 $B = -3/5$，得 $C = 7/25$
   
   因此，特解为 $y_p = (1/3) x^3 - (3/5) x^2 + (7/25) x$。
   
   通解为 $y = y_c + y_p = C_1 + C_2 e^(-5/2 x) + (1/3) x^3 - (3/5) x^2 + (7/25) x$。
   ]

   (2)  $y'' - 6 y' + 9 y = (x + 1) e^(3x)$
   #answer-process[
   首先解对应的齐次方程 $y'' - 6 y' + 9 y = 0$。
   
   特征方程为 $r^2 - 6 r + 9 = 0$，解得 $r = 3$（重根）。
   
   因此，齐次方程的通解为 $y_c = (C_1 + C_2 x) e^(3x)$。
   
   对于非齐次项 $(x + 1) e^(3x)$，由于 $r = 3$ 是二重根，所以特解形式应为 $y_p = x^2 (A x + B) e^(3x) = (A x^3 + B x^2) e^(3x)$。
   
   计算导数：
   $y_p' = (3A x^3 + (3A + 3B) x^2 + 2B x) e^(3x)$
   $y_p'' = (9A x^3 + (18A + 9B) x^2 + (6A + 12B) x + 2B) e^(3x)$
   
   代入原方程：
   $y_p'' - 6 y_p' + 9 y_p = (x + 1) e^(3x)$
   $6A x + 2B = x + 1$
   
   比较系数：
   $6A = 1$，得 $A = 1/6$
   $2B = 1$，得 $B = 1/2$
   
   因此，特解为 $y_p = (1/6 x^3 + 1/2 x^2) e^(3x)$。
   
   通解为 $y = y_c + y_p = (C_1 + C_2 x + 1/6 x^3 + 1/2 x^2) e^(3x)$。
   ]

4. 求下列微分方程满足所给初值条件的特解：

   (1)  $y'' - 3 y' + 2 y = 5, y|_(x = 0) = 1, y'|_(x = 0) = 2$;
   #answer-process[
   首先解对应的齐次方程 $y'' - 3 y' + 2 y = 0$。
   
   特征方程为 $r^2 - 3 r + 2 = 0$，解得 $r = 1$ 或 $r = 2$。
   
   因此，齐次方程的通解为 $y_c = C_1 e^x + C_2 e^(2x)$。
   
   对于非齐次项 $5$，由于 $0$ 不是特征根，所以特解形式应为 $y_p = A$。
   
   代入原方程：$0 - 3 dot 0 + 2 A = 5$，得 $A = 5/2$。
   
   因此，特解为 $y_p = 5/2$。
   
   通解为 $y = y_c + y_p = C_1 e^x + C_2 e^(2x) + 5/2$。
   
   利用初值条件确定常数：
   $y(0) = C_1 + C_2 + 5/2 = 1$，得 $C_1 + C_2 = -3/2$。
   $y' = C_1 e^x + 2 C_2 e^(2x)$
   $y'(0) = C_1 + 2 C_2 = 2$。
   
   解方程组：
   $C_1 + C_2 = -3/2$
   $C_1 + 2 C_2 = 2$
   
   得 $C_2 = 7/2$，$C_1 = -5$。
   
   因此，特解为 $y = -5 e^x + 7/2 e^(2x) + 5/2$。
   ]

   (2)  $y'' - 10 y' + 9 y = e^(2x), y|_(x=0) = 6/7, y'|_(x=0) = 33/7$ .
   #answer-process[
   首先解对应的齐次方程 $y'' - 10 y' + 9 y = 0$。
   
   特征方程为 $r^2 - 10 r + 9 = 0$，解得 $r = 1$ 或 $r = 9$。
   
   因此，齐次方程的通解为 $y_c = C_1 e^x + C_2 e^(9x)$。
   
   对于非齐次项 $e^(2x)$，由于 $2$ 不是特征根，所以特解形式应为 $y_p = A e^(2x)$。
   
   计算导数：
   $y_p' = 2A e^(2x)$
   $y_p'' = 4A e^(2x)$
   
   代入原方程：
   $4A e^(2x) - 10 dot 2A e^(2x) + 9 A e^(2x) = e^(2x)$
   $-7A e^(2x) = e^(2x)$
   
   得 $A = -1/7$。
   
   因此，特解为 $y_p = -1/7 e^(2x)$。
   
   通解为 $y = y_c + y_p = C_1 e^x + C_2 e^(9x) - 1/7 e^(2x)$。
   
   利用初值条件确定常数：
   $y(0) = C_1 + C_2 - 1/7 = 6/7$，得 $C_1 + C_2 = 1$。
   $y' = C_1 e^x + 9 C_2 e^(9x) - 2/7 e^(2x)$
   $y'(0) = C_1 + 9 C_2 - 2/7 = 33/7$，得 $C_1 + 9 C_2 = 5$。
   
   解方程组：
   $C_1 + C_2 = 1$
   $C_1 + 9 C_2 = 5$
   
   得 $C_2 = 1/2$，$C_1 = 1/2$。
   
   因此，特解为 $y = 1/2 e^x + 1/2 e^(9x) - 1/7 e^(2x)$。
   ]

#subsection[三、应用题]
5. 大炮以仰角  $alpha$  ，初速度  $v_0$  发射炮弹，若不计空气阻力，求弹道曲线
   #answer-process[
   建立坐标系，设炮弹在时刻 $t$ 的位置为 $(x(t), y(t))$，初始位置为 $(0, 0)$。
   
   在 $x$ 轴方向，炮弹做匀速直线运动，速度为 $v_0 cos alpha$，所以：
   $x(t) = v_0 cos alpha dot t$
   
   在 $y$ 轴方向，炮弹做匀加速直线运动，初速度为 $v_0 sin alpha$，加速度为 $-g$（$g$ 为重力加速度），所以：
   $y(t) = v_0 sin alpha dot t - 1/2 g t^2$
   
   为了得到弹道曲线，消去参数 $t$。从 $x(t)$ 的表达式可以得到：
   $t = x/(v_0 cos alpha)$
   
   代入 $y(t)$ 的表达式：
   $y = v_0 sin alpha dot (x/(v_0 cos alpha)) - 1/2 g (x/(v_0 cos alpha))^2$
   $y = x tan alpha - (g x^2)/(2 v_0^2 cos^2 alpha)$
   
   利用三角恒等式 $1/(cos^2) alpha = 1 + tan^2 alpha$，可以进一步化简：
   $y = x tan alpha - (g x^2 (1 + tan^2 alpha))/(2 v_0^2)$
   
   这就是弹道曲线的方程。
   ]